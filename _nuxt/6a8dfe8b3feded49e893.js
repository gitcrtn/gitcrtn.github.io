(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{145:function(t,e,n){var a=n(164);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n(51).default)("92e7aae6",a,!1,{sourceMap:!1,ident:"ref--2-oneOf-1-0"})},164:function(t,e,n){(t.exports=n(52)(!1)).push([t.i,".mask[data-v-4c0f0cb3]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#fff;background-size:cover;z-index:9999;display:table}",""])},165:function(t,e,n){"use strict";var a=n(145);n.n(a).a},197:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{position:"absolute",height:"100%",width:"100%"}},[n("a-scene",{ref:"scene",staticStyle:{position:"absolute",height:"100%",width:"100%"},attrs:{renderer:"antialias: true;",screenshot:"width: 1024; height: 1024;"},on:{loaded:t.onLoadedScene}},[n("a-assets",[n("a-asset-item",{attrs:{id:"tomatron82-obj",src:"https://carrot.games/assets/shooting/tomatron82/model.obj"}}),t._v(" "),n("a-asset-item",{attrs:{id:"tomatron82-mtl",src:"https://carrot.games/assets/shooting/tomatron82/materials.mtl"}}),t._v(" "),n("audio",{attrs:{id:"screenshot-sound",src:"https://carrot.games/assets/shooting/sound/camera-se.mp3"}})],1),t._v(" "),n("stage"),t._v(" "),n("targets",{ref:"targets",attrs:{position:"0 2 -10"},on:{smash:t.onSmashTarget}}),t._v(" "),n("shooting-menu",{ref:"menu",attrs:{title:t.title,position:"0 0 -3",mode:t.menuMode,score:t.score,maxTime:30},on:{"click-start":t.onClickStart,"start-ingame":t.onStartIngame,"finish-ingame":t.onFinishIngame,"click-reset":t.onClickReset}}),t._v(" "),n("controller",{on:{trigger:function(e){t.onTriggerController()},"click-trackpad":t.onClickTrackpad,"change-touch-position":t.onChangeTouchPosition}},[n("controller-menu",{ref:"contextMenu",attrs:{touchDegree:t.touchDegree,touchRadius:t.touchRadius,menuData:t.menuData}})],1),t._v(" "),n("a-camera",{attrs:{position:"0 10 0"}})],1),t._v(" "),n("i",{staticClass:"fas fa-camera",attrs:{id:"screenshot-icon"}}),t._v(" "),t.showMask?n("div",{staticClass:"mask"}):t._e()],1)};a._withStripped=!0;var o,r,i=n(1),s=n.n(i),c=n(4),u=n.n(c),l=(n(53),n(163),n(162),n(50)),h=n.n(l),d=n(166),p=n.n(d),m=(o=u()(s.a.mark(function t(e,n,a){var o,r,i,c;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.components.screenshot,r=o.el.object3D,i=o.el.renderer,c=o.getRenderTarget(a.width,a.height),t.abrupt("return",new p.a(function(t){i.render(r,n,c,!0),t(c)}));case 5:case"end":return t.stop()}},t,this)})),function(t,e,n){return o.apply(this,arguments)}),f=(r=u()(s.a.mark(function t(e){var n,a,o,r,i,c,u,l,h,d,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"perspective";return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.components.screenshot,a=n.setCapture(p),o=a.camera,r=a.size,i=a.projection,c=n.el.renderer.autoClear,u=n.el.renderer,l=new Uint8Array(4*r.width*r.height),n.resize(r.width,r.height),u.autoClear=!0,t.next=12,m(e,o,r);case 12:h=t.sent,u.autoClear=c,u.readRenderTargetPixels(h,0,0,r.width,r.height,l),d=new ImageData(new Uint8ClampedArray(l),r.width,r.height),n.quad.visible=!1,n.ctx.putImageData(d,0,0),"perspective"===i&&(n.ctx.globalCompositeOperation="copy",n.ctx.scale(1,-1),n.ctx.translate(0,-d.height),n.ctx.drawImage(n.canvas,0,0),n.ctx.setTransform(1,0,0,1,0,0),n.ctx.globalCompositeOperation="source-over"),n.saveCapture();case 20:case"end":return t.stop()}},t,this)})),function(t){return r.apply(this,arguments)}),g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-entity",{attrs:{"oculus-go-controls":"model: false",raycaster:"objects: .collidable"},on:{triggerchanged:t.onChangeTrigger,trackpadchanged:t.onChangeTrackpad,triggerdown:t.onDownTrigger,triggerup:t.onUpTrigger,trackpaddown:t.onDownTrackpad,trackpadup:t.onUpTrackpad,trackpadtouchstart:t.onTouchStartTrackpad,trackpadtouchend:t.onTouchEndTrackpad,trackpadmoved:t.onMovedTrackpad,"raycaster-intersection":t.onGetRaycasterIntersection}},[n("a-entity",{attrs:{"obj-model":"obj: #tomatron82-obj; mtl: #tomatron82-mtl",rotation:"0 0 0"}}),t._v(" "),n("a-cone",{attrs:{material:"side: single; color: white; transparent: true; opacity: 0.5","radius-bottom":"0.01","radius-top":"0.001",height:"6",position:"0.005 -0.007 -3",rotation:"-90 0 0"}}),t._v(" "),t._t("default"),t._v(" "),t.debug?n("a-entity",{attrs:{geometry:"primitive: plane; height: 1; width: 1",material:"shader: flat;",position:"0 2 -5"}},[n("a-text",{attrs:{id:"home",value:t.text,align:"center",color:"black",position:"0 0 0"}}),t._v(" "),n("a-text",{attrs:{id:"home2",value:t.text2,align:"center",color:"black",position:"0 -0.25 0"}})],1):t._e()],2)};g._withStripped=!0;function w(t,e){var n=Math.round(Math.atan2(e,t)*(180/Math.PI));return n<0?n+360:n}var v={name:"GameShootingController",data:function(){return{text:"default",text2:"default",debug:!1}},methods:{onChangeTrigger:function(t){},onChangeTrackpad:function(t){},onDownTrigger:function(){this.$emit("trigger")},onUpTrigger:function(){},onDownTrackpad:function(){this.$emit("click-trackpad")},onUpTrackpad:function(){},onTouchStartTrackpad:function(){},onTouchEndTrackpad:function(){},onMovedTrackpad:function(t){var e=t.detail;this.$emit("change-touch-position",{degree:Math.round(function(t){return w(t.x,t.y)}(e)),radius:function(t){return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))}(e)})},onIntersectRaycaster:function(){},onGetRaycasterIntersection:function(t){}}},I=n(17),k=Object(I.a)(v,g,[],!1,null,null,null).exports,x=function(){var t=this.$createElement,e=this._self._c||t;return e("a-entity",[e("a-sky",{attrs:{color:"#A0D0FF"}}),this._v(" "),e("a-plane",{attrs:{width:"100",height:"100",color:"green",position:"0 0 0",rotation:"-90 0 0"}})],1)};x._withStripped=!0;var y={name:"GameShootingStage",methods:{}},b=Object(I.a)(y,x,[],!1,null,null,null).exports,C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-entity",t._l(t.targets,function(e){return n("a-cylinder",{key:e.id,staticClass:"collidable",attrs:{color:t.getColor(e),radius:"0.5",height:"0.1",rotation:"90 0 0",position:t.getPosition(e)},on:{"raycaster-intersected":function(n){t.onIntersectRaycaster(e.id,!0)},"raycaster-intersected-cleared":function(n){t.onIntersectRaycaster(e.id,!1)}}})}))};C._withStripped=!0;var S=n(0),T={name:"GameShootingTargets",props:{maxTime:{type:Number,default:0}},data:function(){return{targets:{},idCount:0,hitId:-1,lifeTime:5e3,spawnInterval:2e3,timeId:null}},methods:{spawn:function(){S.a.set(this.targets,this.idCount,{id:this.idCount,x:h.a.random(-2,2),y:h.a.random(0,4),hit:!1});var t=this.targets,e=this.idCount,n=S.a.delete;h.a.delay(function(){n(t,e)},this.lifeTime),this.idCount++},getPosition:function(t){return t.x+" "+t.y+" 0"},getColor:function(t){return t.hit?"red":"white"},onIntersectRaycaster:function(t,e){S.a.set(this.targets[t],"hit",e),this.hitId=e?t:-1},click:function(){this.hitId<0||(S.a.delete(this.targets,this.hitId),this.hitId=-1,this.$emit("smash"))},start:function(){this.spawn();var t=this.spawn;this.timeId=setInterval(t,this.spawnInterval)},finish:function(){var t=this;clearInterval(this.timeId),h.a.keys(this.targets).forEach(function(e){S.a.delete(t.targets,e)})}}},M=Object(I.a)(T,C,[],!1,null,null,null).exports,D=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-entity",[t.showTitle?n("a-entity",[t.showCredit?t._e():n("a-entity",[n("a-plane",{attrs:{color:"white",position:"0 2 0",width:"2",height:"0.5"}},[n("a-text",{attrs:{value:t.title,align:"center",color:"black"}})],1),t._v(" "),n("menu-button",{attrs:{position:"0 1 0",text:"Start"},model:{value:t.startIntersect,callback:function(e){t.startIntersect=e},expression:"startIntersect"}}),t._v(" "),n("menu-button",{attrs:{position:"1.8 0.9 0.7",rotation:"0 -40 0",scale:"0.5 0.5 1",text:"Credit"},model:{value:t.creditIntersect,callback:function(e){t.creditIntersect=e},expression:"creditIntersect"}})],1),t._v(" "),t.showCredit?n("a-plane",{attrs:{position:"0 1.5 1",width:"2",height:"2"}},[n("a-text",{attrs:{value:"Staff",align:"center",color:"black",position:"0 0.8 0"}}),t._v(" "),n("a-text",{attrs:{value:"Programming: @Carotene",align:"left",color:"black",position:"-0.6 0.3 0",scale:"0.4 0.4 1"}}),t._v(" "),n("a-text",{attrs:{value:"Modeling: Sebastien Labrunie (CC-BY)",align:"left",color:"black",position:"-0.6 0 0",scale:"0.4 0.4 1"}}),t._v(" "),n("a-text",{attrs:{value:"TOMATRON 82: https://poly.google.com/view/3wuytTnJjQ7",align:"left",color:"black",position:"-0.6 -0.2 0",scale:"0.3 0.3 1"}}),t._v(" "),n("menu-button",{attrs:{position:"0 -0.7 0.1",scale:"0.5 0.5 1",text:"close"},model:{value:t.closeCreditIntersect,callback:function(e){t.closeCreditIntersect=e},expression:"closeCreditIntersect"}})],1):t._e()],1):t._e(),t._v(" "),t.showIngame?n("a-entity",{attrs:{position:"0 1 0"}},[t.showIngameCountDown?n("a-entity",{attrs:{position:"0 0.8 0",scale:"2 2 0"}},[n("a-text",{attrs:{value:t.countDown,color:"black",align:"center",position:"0 0 0"}})],1):t._e(),t._v(" "),t.showIngameIndicator?n("a-entity",{attrs:{position:"0 -0.4 0"}},[n("a-text",{attrs:{value:t.scoreText,align:"center",color:"black",position:"-1 0 0"}}),t._v(" "),n("a-text",{attrs:{value:t.timeText,align:"center",color:"black",position:"1 0 0"}})],1):t._e()],1):t._e(),t._v(" "),t.showResult?n("a-entity",[n("a-plane",{attrs:{color:"white",position:"0 2 0",width:"2",height:"0.5"}},[n("a-text",{attrs:{value:t.scoreText,align:"center",color:"black"}})],1),t._v(" "),n("menu-button",{attrs:{position:"0 1 0",text:"Back to Title"},model:{value:t.backIntersect,callback:function(e){t.backIntersect=e},expression:"backIntersect"}})],1):t._e()],1)};D._withStripped=!0;var R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-plane",{staticClass:"collidable",attrs:{color:t.color,width:"1.5",height:"0.5"},on:{"raycaster-intersected":function(e){t.onIntersectRaycaster(!0)},"raycaster-intersected-cleared":function(e){t.onIntersectRaycaster(!1)}}},[n("a-text",{attrs:{value:t.text,align:"center",color:"black"}})],1)};R._withStripped=!0;var $={name:"GameShootingButton",props:{value:{type:Boolean,default:!1},text:{type:String,default:""}},data:function(){return{hit:!1}},computed:{color:function(){return this.hit?"cyan":"white"}},methods:{onIntersectRaycaster:function(t){this.hit=t,this.$emit("input",t)}}},j={name:"GameShootingMenu",components:{MenuButton:Object(I.a)($,R,[],!1,null,null,null).exports},props:{title:{type:String,default:""},mode:{type:String,default:"title"},score:{type:Number,default:0},maxTime:{type:Number,default:0}},data:function(){return{showTitle:!0,showIngame:!1,showResult:!1,showCredit:!1,showIngameCountDown:!1,showIngameIndicator:!1,countDown:0,timeCount:0,startIntersect:!1,backIntersect:!1,creditIntersect:!1,closeCreditIntersect:!1}},watch:{mode:function(t){switch(t){case"title":this.showResult=!1,this.showIngame=!1,this.showTitle=!0;break;case"ingame":this.showTitle=!1,this.showResult=!1,this.countDown=3,this.timeCount=this.maxTime,this.showIngameCountDown=!0,this.showIngame=!0,this.startCountDown();break;case"result":this.showIngameCountDown=!1,this.showIngameIndicator=!1,this.showTitle=!1,this.showIngame=!1,this.showResult=!0;break;case"hide":this.showTitle=!1,this.showIngame=!1,this.showResult=!1}}},computed:{scoreText:function(){return"Score: "+this.score},timeText:function(){return"Time: "+this.timeCount}},methods:{click:function(){this.startIntersect?(this.$emit("click-start"),this.startIntersect=!1):this.backIntersect?(this.$emit("click-reset"),this.backIntersect=!1):this.creditIntersect?(this.showCredit=!0,this.creditIntersect=!1):this.closeCreditIntersect&&(this.showCredit=!1,this.creditIntersect=!1)},startCountDown:function(){var t=this,e=setInterval(function(){t.countDown--},1e3);h.a.delay(function(){clearInterval(e),t.countDown="Start!",t.showIngameIndicator=!0},3e3),h.a.delay(function(){t.showIngameCountDown=!1,t.$emit("start-ingame"),t.startTimeCount()},4e3)},startTimeCount:function(){var t=this,e=setInterval(function(){t.timeCount--},1e3);h.a.delay(function(){clearInterval(e),t.countDown="Time Over!",t.showIngameCountDown=!0,h.a.delay(function(){t.$emit("finish-ingame")},2e3)},1e3*this.maxTime)}}},E=Object(I.a)(j,D,[],!1,null,null,null).exports,O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isShow?n("a-entity",{attrs:{position:"0 0.07 -0.2",rotation:"-70 0 0",scale:"0.05 0.05 1"}},[n("a-circle",{attrs:{radius:"1",color:"white",material:"side: double;"}},[n("a-entity",{attrs:{rotation:t.touchLineRotation,position:"0 0 0.005"}},[n("a-entity",{attrs:{scale:t.touchLineScale}},[n("a-plane",{attrs:{width:"1",height:"0.1",position:"0.5 0 0",color:"red"}})],1),t._v(" "),n("a-circle",{attrs:{radius:"0.1",color:"red"}})],1)],1),t._v(" "),n("a-entity",{attrs:{scale:"1 1 0.03"}},[n("a-torus",{attrs:{arc:"360",radius:"0.98","radius-tubular":"0.2",color:"black",scale:"1 1 0.6"}}),t._v(" "),t._l(t.menuData,function(e,a){return n("a-torus",{key:a,attrs:{arc:"58",radius:t.getMenuRadius(a),"radius-tubular":"0.2",scale:t.getMenuScale(a),position:t.getMenuPosition(a),rotation:t.getMenuRotation(a),color:t.getMenuColor(e)}},[t.isShowIcon(e)?n("a-plane",{attrs:{width:"0.5",height:"0.5",position:t.getIconPosition(a),color:"white",material:t.getIconMaterial(e)}}):t._e(),t._v(" "),n("sound-entity",{ref:"menuSounds",refInFor:!0,attrs:{soundId:t.getSoundId(e)}})],1)})],2)],1):t._e()};O._withStripped=!0;var A=n(133),P=n.n(A),F=function(){var t=u()(s.a.mark(function t(e,n){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(h.a.isFunction(e)){t.next=2;break}return t.abrupt("return");case 2:if("AsyncFunction"!==e.constructor.name){t.next=12;break}if(!n){t.next=8;break}return t.next=6,e.apply(void 0,P()(n));case 6:t.next=10;break;case 8:return t.next=10,e();case 10:t.next=13;break;case 12:n?e.apply(void 0,P()(n)):e();case 13:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),G=function(){var t=this.$createElement;return(this._self._c||t)("a-entity",{ref:"sound",attrs:{sound:this.sound}})};G._withStripped=!0;var L={name:"CommonSound",props:{soundId:{type:String,default:null}},computed:{sound:function(){return h.a.isEmpty(this.soundId)?"":"src: #"+this.soundId+"; volume: 0.3"}},methods:{play:function(){this.$refs.sound.components.sound.playSound()}}},N={name:"CommonControllerMenu",components:{soundEntity:Object(I.a)(L,G,[],!1,null,null,null).exports},props:{touchDegree:{type:Number,default:0},touchRadius:{type:Number,default:0},menuData:{type:Array,default:function(){return[]}}},data:function(){return{isShow:!1,menuArc:60,detectionDistance:.6}},computed:{touchLineRotation:function(){return"0 0 "+-this.touchDegree},touchLineScale:function(){return this.touchRadius+" 1 1"},selectedMenuIndex:function(){return this.touchRadius<=this.detectionDistance?null:5-Math.floor(this.touchDegree/this.menuArc)}},methods:{getMenuSelected:function(t){return!_.isEmpty(this.menuData[t].data)&&this.selectedMenuIndex===t},getMenuRotation:function(t){return"0 0 "+this.menuArc*t},getMenuPosition:function(t){return"0 0 "+(this.getMenuSelected(t)?.2:0)},getMenuScale:function(t){var e=this.getMenuSelected(t)?1.2:1;return e+" "+e+" 1"},getMenuRadius:function(t){return this.getMenuSelected(t)?.9:1},getMenuColor:function(t){return t.data?"white":"#A0A0A0"},getSoundId:function(t){return t.data&&t.data.soundId?t.data.soundId:null},getIconPosition:function(t){return this.getMenuSelected(t)?"0.8 0.55 0.5":"0.9 0.6 0.5"},getIconMaterial:function(t){return"shader:html;target:#"+t.data.iconId+";transparent:true;"},isShowIcon:function(t){return!_.isEmpty(t.data)},click:function(){var t=u()(s.a.mark(function t(){var e;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isShow){t.next=3;break}return this.isShow=!0,t.abrupt("return");case 3:if(!_.isNull(this.selectedMenuIndex)){t.next=6;break}return this.isShow=!1,t.abrupt("return");case 6:if(e=this.menuData[this.selectedMenuIndex].data,!_.isEmpty(e)){t.next=9;break}return t.abrupt("return");case 9:if(_.isEmpty(e.soundId)||this.$refs.menuSounds[this.selectedMenuIndex].play(),!_.isFunction(e.onClickMenu)){t.next=13;break}return t.next=13,F(e.onClickMenu);case 13:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}},U={name:"GameShooting",components:{Controller:k,Stage:b,Targets:M,ShootingMenu:E,ControllerMenu:Object(I.a)(N,O,[],!1,null,null,null).exports},data:function(){var t=h.a.times(6);return t[0]={data:{iconId:"screenshot-icon",soundId:"screenshot-sound"}},{title:"Simple Shooting",menuMode:"title",scoreCount:0,scoreWeight:10,touchDegree:0,touchRadius:0,showMask:!0,menuData:t}},computed:{score:function(){return this.scoreCount*this.scoreWeight}},methods:{onTriggerController:function(){this.$refs.targets.click(),this.$refs.menu.click()},onClickTrackpad:function(){var t=u()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.$refs.contextMenu.click();case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),onChangeTouchPosition:function(t){this.$refs.contextMenu.isShow&&(this.touchDegree=t.degree,this.touchRadius=t.radius)},onLoadedScene:function(){var t=this;this.showMask=!1,this.menuData[0].data.onClickMenu=u()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(t.$refs.scene);case 2:case"end":return e.stop()}},e,t)}))},onClickStart:function(){this.scoreCount=0,this.menuMode="ingame"},onClickReset:function(){this.menuMode="title"},onStartIngame:function(){this.$refs.targets.start()},onFinishIngame:function(){this.$refs.targets.finish(),this.menuMode="result"},onSmashTarget:function(){this.scoreCount++}}},B=(n(165),Object(I.a)(U,a,[],!1,null,"4c0f0cb3",null));e.default=B.exports}}]);